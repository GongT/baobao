## API Report File for "@idlebox/section-buffer"

> Do not edit this file. It is a report generated by [API Extractor](https://api-extractor.com/).

```ts

/// <reference types="node" />

import { AsyncDisposable } from '@idlebox/common';
import { EventRegister } from '@idlebox/common';
import fs from 'fs/promises';
import { ReadStream } from 'fs';
import { Stats } from 'fs';
import { Transform } from 'stream';
import { TransformCallback } from 'stream';
import { Writable as Writable_2 } from 'stream';

// Warning: (ae-missing-release-tag) "AsyncLock" is part of the package's API, but it is missing a release tag (@alpha, @beta, @public, or @internal)
//
// @public (undocumented)
export class AsyncLock {
    // (undocumented)
    acquire(title: string, weak?: boolean): boolean;
    // (undocumented)
    protected current?: string;
    // (undocumented)
    static finish(title: string): MethodDecorator;
    // (undocumented)
    static get(obj: any): AsyncLock;
    // (undocumented)
    static protect(title: string, weak?: boolean): MethodDecorator;
    // (undocumented)
    release(title: string): void;
    // (undocumented)
    require(title: string): void;
    // (undocumented)
    static require(title: string): MethodDecorator;
    // (undocumented)
    static start(title: string): MethodDecorator;
}

// Warning: (ae-missing-release-tag) "CacheFile" is part of the package's API, but it is missing a release tag (@alpha, @beta, @public, or @internal)
//
// @public (undocumented)
export class CacheFile extends AsyncDisposable {
    constructor(location: string);
    // (undocumented)
    closeWriter(): Promise<void>;
    // (undocumented)
    commitBadBlock(): Promise<void>;
    // (undocumented)
    get dataUsage(): number;
    // (undocumented)
    destroy(): Promise<void>;
    // (undocumented)
    diskUsage(): Promise<number>;
    // (undocumented)
    isExists(): boolean;
    // (undocumented)
    protected readonly location: string;
    // (undocumented)
    markBad(part: ICachePartMeta): void;
    // (undocumented)
    get metaJson(): any;
    // Warning: (tsdoc-escape-right-brace) The "}" character should be escaped using a backslash to avoid confusion with a TSDoc inline tag
    // Warning: (tsdoc-malformed-inline-tag) Expecting a TSDoc tag starting with "{@"
    // Warning: (tsdoc-escape-right-brace) The "}" character should be escaped using a backslash to avoid confusion with a TSDoc inline tag
    // Warning: (tsdoc-malformed-inline-tag) Expecting a TSDoc tag starting with "{@"
    //
    // (undocumented)
    openRead(): Promise<void>;
    // Warning: (ae-forgotten-export) The symbol "ICachePartMeta" needs to be exported by the entry point __create_index.generated.d.ts
    //
    // (undocumented)
    get parts(): ICachePartMeta[];
    // (undocumented)
    prepareAppend(): Promise<void>;
    // (undocumented)
    prepareCreate(metaJson: any): Promise<void>;
    // (undocumented)
    startEmitting(): Promise<ICacheFileStreamer>;
    // (undocumented)
    writePart(part: ICacheRecv): Promise<void>;
}

// Warning: (ae-missing-release-tag) "createSectionBuffer" is part of the package's API, but it is missing a release tag (@alpha, @beta, @public, or @internal)
//
// @public (undocumented)
export function createSectionBuffer<MetaType>(options: ISectionBufferOptions<MetaType>): Promise<SectionBuffer<MetaType>>;

// Warning: (ae-missing-release-tag) "defaults" is part of the package's API, but it is missing a release tag (@alpha, @beta, @public, or @internal)
//
// @public (undocumented)
export const defaults: {
    syncSize: number;
    syncInterval: number;
};

// Warning: (ae-missing-release-tag) "FileDataError" is part of the package's API, but it is missing a release tag (@alpha, @beta, @public, or @internal)
//
// @public (undocumented)
export class FileDataError extends Error {
    constructor(e: Error, file: string);
    // (undocumented)
    readonly file: string;
    // (undocumented)
    stack: string;
}

// Warning: (ae-missing-release-tag) "FileStructureError" is part of the package's API, but it is missing a release tag (@alpha, @beta, @public, or @internal)
//
// @public (undocumented)
export class FileStructureError extends Error {
    constructor(e: Error, file: string);
    // (undocumented)
    readonly file: string;
    // (undocumented)
    stack: string;
}

// Warning: (ae-missing-release-tag) "HashError" is part of the package's API, but it is missing a release tag (@alpha, @beta, @public, or @internal)
//
// @public (undocumented)
export class HashError extends Error {
    constructor(offset: string, want: string, got: string);
    // (undocumented)
    readonly got: string;
    // (undocumented)
    readonly offset: string;
    // (undocumented)
    readonly want: string;
}

// Warning: (ae-forgotten-export) The symbol "CacheFileReader" needs to be exported by the entry point __create_index.generated.d.ts
// Warning: (ae-missing-release-tag) "ICacheFileReader" is part of the package's API, but it is missing a release tag (@alpha, @beta, @public, or @internal)
//
// @public (undocumented)
export interface ICacheFileReader extends CacheFileReader {
}

// Warning: (ae-forgotten-export) The symbol "CacheFileStreamer" needs to be exported by the entry point __create_index.generated.d.ts
// Warning: (ae-missing-release-tag) "ICacheFileStreamer" is part of the package's API, but it is missing a release tag (@alpha, @beta, @public, or @internal)
//
// @public (undocumented)
export interface ICacheFileStreamer extends CacheFileStreamer {
}

// Warning: (ae-forgotten-export) The symbol "CacheFileWriter" needs to be exported by the entry point __create_index.generated.d.ts
// Warning: (ae-missing-release-tag) "ICacheFileWriter" is part of the package's API, but it is missing a release tag (@alpha, @beta, @public, or @internal)
//
// @public (undocumented)
export interface ICacheFileWriter extends CacheFileWriter {
}

// Warning: (ae-missing-release-tag) "ICacheRecv" is part of the package's API, but it is missing a release tag (@alpha, @beta, @public, or @internal)
//
// @public
export interface ICacheRecv {
    // (undocumented)
    readonly buffers: readonly Uint8Array[];
    // (undocumented)
    readonly start: number;
}

// Warning: (ae-missing-release-tag) "IMemCacheEmit" is part of the package's API, but it is missing a release tag (@alpha, @beta, @public, or @internal)
//
// @public (undocumented)
export interface IMemCacheEmit {
    // (undocumented)
    readonly buffers: readonly Uint8Array[];
    // (undocumented)
    readonly start: number;
    // (undocumented)
    readonly totalSize: number;
}

// Warning: (ae-missing-release-tag) "IMemCachePart" is part of the package's API, but it is missing a release tag (@alpha, @beta, @public, or @internal)
//
// @public (undocumented)
export interface IMemCachePart {
    // (undocumented)
    readonly buffer?: Uint8Array;
    // (undocumented)
    readonly length: number;
    // (undocumented)
    readonly start: number;
}

// Warning: (ae-missing-release-tag) "ISectionBufferOptions" is part of the package's API, but it is missing a release tag (@alpha, @beta, @public, or @internal)
//
// @public (undocumented)
export interface ISectionBufferOptions<MetaType> {
    // (undocumented)
    readonly cacheFile: string;
    // (undocumented)
    readonly fileSize: number;
    // (undocumented)
    readonly metadata: MetaType;
    // (undocumented)
    readonly syncInterval?: number;
    // (undocumented)
    readonly syncSize?: number;
    // (undocumented)
    readonly targetFile: string;
}

// Warning: (ae-missing-release-tag) "ISectionData" is part of the package's API, but it is missing a release tag (@alpha, @beta, @public, or @internal)
//
// @public (undocumented)
export interface ISectionData {
    // (undocumented)
    readonly buffer: Buffer | NodeJS.ReadableStream;
    // (undocumented)
    readonly start: number;
}

// Warning: (ae-missing-release-tag) "IView" is part of the package's API, but it is missing a release tag (@alpha, @beta, @public, or @internal)
//
// @public (undocumented)
export interface IView {
    // (undocumented)
    readonly length: number;
    // (undocumented)
    readonly start: number;
    // (undocumented)
    readonly written: boolean;
}

// Warning: (ae-missing-release-tag) "LossyAsyncQueue" is part of the package's API, but it is missing a release tag (@alpha, @beta, @public, or @internal)
//
// @public (undocumented)
export class LossyAsyncQueue<T = void> {
    constructor(callback: (arg: T) => Promise<void>);
    // (undocumented)
    dispose(): Promise<void>;
    // (undocumented)
    lock(l: boolean): void;
    // (undocumented)
    readonly onBusy: EventRegister<boolean>;
    // (undocumented)
    readonly onComplete: EventRegister<void>;
    // (undocumented)
    readonly onError: EventRegister<Error>;
    // (undocumented)
    get promise(): Promise<void> | undefined;
    // (undocumented)
    pushQueue(arg: T): void;
}

// Warning: (ae-missing-release-tag) "makeEmptyFile" is part of the package's API, but it is missing a release tag (@alpha, @beta, @public, or @internal)
//
// @public (undocumented)
export function makeEmptyFile(path: string, size: number): Promise<void>;

// Warning: (ae-missing-release-tag) "Md5Hasher" is part of the package's API, but it is missing a release tag (@alpha, @beta, @public, or @internal)
//
// @public (undocumented)
export class Md5Hasher extends Transform {
    // (undocumented)
    _final(callback: TransformCallback): void;
    // (undocumented)
    getHash(): Buffer;
    // (undocumented)
    sameWith(wantMd5: Buffer): boolean;
    // (undocumented)
    _transform(chunk: Buffer, _: BufferEncoding, callback: TransformCallback): void;
}

// Warning: (ae-missing-release-tag) "MemoryCacheController" is part of the package's API, but it is missing a release tag (@alpha, @beta, @public, or @internal)
//
// @public (undocumented)
export class MemoryCacheController {
    constructor(maxSize: number);
    // (undocumented)
    check(from?: number, to?: number): void;
    // (undocumented)
    isFullfilled(): boolean;
    // (undocumented)
    get memoryUsage(): number;
    // (undocumented)
    punchHole({ length, start }: IMemCachePart): void;
    // (undocumented)
    push({ length, start: starting, buffer }: IMemCachePart): void;
    // (undocumented)
    shift(): IMemCacheEmit | undefined;
    // (undocumented)
    get size(): number;
    // (undocumented)
    get viewState(): readonly IView[];
}

// Warning: (ae-missing-release-tag) "openCacheFileForRead" is part of the package's API, but it is missing a release tag (@alpha, @beta, @public, or @internal)
//
// @public (undocumented)
export function openCacheFileForRead(file: string): Promise<ICacheFileReader | undefined>;

// Warning: (ae-missing-release-tag) "openCacheFileForStream" is part of the package's API, but it is missing a release tag (@alpha, @beta, @public, or @internal)
//
// @public (undocumented)
export function openCacheFileForStream(file: string): Promise<ICacheFileStreamer>;

// Warning: (ae-missing-release-tag) "openCacheFileForWrite" is part of the package's API, but it is missing a release tag (@alpha, @beta, @public, or @internal)
//
// @public (undocumented)
export function openCacheFileForWrite(file: string, create: boolean): Promise<CacheFileWriter>;

// Warning: (ae-missing-release-tag) "SectionBuffer" is part of the package's API, but it is missing a release tag (@alpha, @beta, @public, or @internal)
//
// @public (undocumented)
export class SectionBuffer<MetaType> extends AsyncDisposable {
    constructor(options: ISectionBufferOptions<MetaType>);
    // (undocumented)
    protected _complete: boolean;
    // (undocumented)
    dispose(): Promise<void>;
    // (undocumented)
    protected readonly file: CacheFile;
    // (undocumented)
    forceSync(): void;
    // (undocumented)
    get isCompleted(): boolean;
    // (undocumented)
    protected _isManual: boolean;
    // (undocumented)
    protected readonly mem: MemoryCacheController;
    // (undocumented)
    readonly onBusy: EventRegister<boolean>;
    // (undocumented)
    readonly onComplete: EventRegister<boolean>;
    // (undocumented)
    readonly onError: EventRegister<Error>;
    // (undocumented)
    protected readonly options: Required<ISectionBufferOptions<MetaType>>;
    // (undocumented)
    get progress(): {
        fullfilled: number;
        view: readonly IView[];
        total: number;
    };
    // (undocumented)
    push(section: ISectionData): void;
    // Warning: (ae-forgotten-export) The symbol "TriggerKind" needs to be exported by the entry point __create_index.generated.d.ts
    //
    // (undocumented)
    protected readonly queue: LossyAsyncQueue<TriggerKind>;
    // Warning: (ae-forgotten-export) The symbol "ILive" needs to be exported by the entry point __create_index.generated.d.ts
    //
    // (undocumented)
    protected readonly receivers: ILive[];
    // (undocumented)
    start(): Promise<boolean>;
    // (undocumented)
    sync(): Promise<void>;
    // (undocumented)
    protected _timer?: NodeJS.Timer;
}

// Warning: (ae-missing-release-tag) "SignatureError" is part of the package's API, but it is missing a release tag (@alpha, @beta, @public, or @internal)
//
// @public (undocumented)
export class SignatureError extends Error {
}

// Warning: (ae-missing-release-tag) "StreamReceiver" is part of the package's API, but it is missing a release tag (@alpha, @beta, @public, or @internal)
//
// @public (undocumented)
export class StreamReceiver extends Writable_2 {
    constructor(_source: NodeJS.ReadableStream);
    // (undocumented)
    _final(_callback: (error?: Error | null | undefined) => void): void;
    // (undocumented)
    _write(_chunk: any, _encoding: BufferEncoding, _callback: (error?: Error | null | undefined) => void): void;
}

// (No @packageDocumentation comment for this package)

```
